<div class="autopulse-settings">
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <b>ST-AutoPulse Lite</b>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">

            <!-- Status -->
            <div class="autopulse-status" id="autopulse_status_bar">
                <span class="autopulse-status-dot disconnected" id="autopulse_status_dot"></span>
                <span id="autopulse_status_text">已停用</span>
            </div>

            <!-- Enable Toggle -->
            <label class="checkbox_label" for="autopulse_enabled">
                <input type="checkbox" id="autopulse_enabled" />
                <span>启用自动消息</span>
            </label>

            <!-- Interval -->
            <div class="autopulse-setting-group">
                <label>消息间隔（分钟）</label>
                <div class="autopulse-interval-row">
                    <input type="range" id="autopulse_interval_range" min="1" max="180" value="30" />
                    <input type="number" id="autopulse_interval_input" min="1" max="180" value="30"
                        class="text_pole autopulse-interval-num" />
                </div>
            </div>

            <!-- Timer Info -->
            <div class="autopulse-timer-info" id="autopulse_timer_info" style="display:none;">
                <span class="fa-solid fa-clock"></span>
                <span id="autopulse_next_trigger">计算中...</span>
            </div>

            <!-- Prompt -->
            <div class="autopulse-setting-group">
                <label>
                    自定义触发提示词
                    <small>（留空使用默认提示词）</small>
                </label>
                <textarea id="autopulse_prompt" class="text_pole autopulse-prompt-input" rows="4"
                    placeholder="例如：一段时间过去了，角色想要主动联系用户。根据当前对话上下文和角色性格，生成一条自然的主动消息。"></textarea>
            </div>

            <!-- Desktop Notification -->
            <label class="checkbox_label" for="autopulse_notify">
                <input type="checkbox" id="autopulse_notify" checked />
                <span>桌面通知</span>
            </label>

            <!-- Manual Trigger -->
            <div class="autopulse-actions">
                <div class="menu_button" id="autopulse_trigger_now">
                    <span class="fa-solid fa-bolt"></span>
                    <span>立即触发一次</span>
                </div>
            </div>

            <hr />

            <!-- Pressure / Anxiety System -->
            <div class="autopulse-section-header">
                <b>情绪压力系统</b>
            </div>

            <div class="autopulse-setting-group">
                <label class="checkbox_label" for="autopulse_pressure_enabled">
                    <input type="checkbox" id="autopulse_pressure_enabled" />
                    <span>启用压力系统</span>
                </label>
                <small class="autopulse-hint"
                    style="display:block; margin-left:24px; color:var(--SmartThemeQuoteColor);">（角色等待越久越焦虑，你回复后会有情绪反应）</small>
            </div>

            <div class="autopulse-setting-group">
                <label>
                    <span>当前压力等级：</span>
                    <span id="autopulse_pressure_display" style="font-weight:bold; color:#4caf50;">😊 等级 0</span>
                </label>
            </div>

            <div class="autopulse-setting-group">
                <label style="display:flex; justify-content:space-between;">
                    <span>最大压力等级</span>
                    <span id="autopulse_pressure_max_display" style="font-weight:bold;">4</span>
                </label>
                <input type="range" id="autopulse_pressure_max" min="1" max="5" value="4" style="width:100%;" />
            </div>

            <div class="autopulse-setting-group">
                <label class="checkbox_label" for="autopulse_pressure_return">
                    <input type="checkbox" id="autopulse_pressure_return" checked />
                    <span>启用回归反应</span>
                </label>
                <small class="autopulse-hint"
                    style="display:block; margin-left:24px; color:var(--SmartThemeQuoteColor);">（你回复后角色根据冷落时长表现被安抚/不满/生气）</small>
            </div>

            <div class="autopulse-actions" style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
                <div id="autopulse_test_pressure_up" class="menu_button" title="模拟压力升级">
                    <span class="fa-solid fa-arrow-up"></span>
                    <span>压力+1</span>
                </div>
                <div id="autopulse_test_pressure_trigger" class="menu_button" title="以当前压力等级触发一次消息">
                    <span class="fa-solid fa-bolt"></span>
                    <span>测试触发</span>
                </div>
                <div id="autopulse_test_return" class="menu_button" title="模拟回归反应">
                    <span class="fa-solid fa-heart"></span>
                    <span>测试回归</span>
                </div>
            </div>

            <hr />

            <!-- Jealousy System -->
            <div class="autopulse-section-header">
                <b>嫉妒系统 💢</b>
            </div>

            <div class="autopulse-setting-group">
                <label class="checkbox_label" for="autopulse_jealousy_enabled">
                    <input type="checkbox" id="autopulse_jealousy_enabled" />
                    <span>启用嫉妒系统</span>
                </label>
                <small class="autopulse-hint"
                    style="display:block; margin-left:24px; color:var(--SmartThemeQuoteColor);">（切换角色时，被离开的角色可能嫉妒弹窗）</small>
            </div>

            <div class="autopulse-setting-group">
                <label>
                    <span>选择会嫉妒的角色：</span>
                    <small class="autopulse-hint"
                        style="display:block; margin-bottom:5px; color:var(--SmartThemeQuoteColor);">（不选=不会触发嫉妒）</small>
                </label>
                <div id="autopulse_jealousy_chars"
                    style="max-height:150px; overflow-y:auto; border:1px solid var(--SmartThemeBorderColor); padding:5px; border-radius:5px;">
                    <span class="autopulse-hint">加载中...</span>
                </div>
            </div>

            <div class="autopulse-setting-group">
                <label>
                    <span>自定义嫉妒提示词</span>
                    <small class="autopulse-hint">（留空使用默认）</small>
                </label>
                <textarea id="autopulse_jealousy_prompt" class="text_pole autopulse-prompt-input" rows="3"
                    placeholder="留空=默认。示例：你发现对方在和别人聊天了，用1句话表达嫉妒，像发微信一样简短。"></textarea>
            </div>

            <div class="autopulse-setting-group">
                <label style="display:flex; justify-content:space-between;">
                    <span>嫉妒触发概率</span>
                    <span id="autopulse_jealousy_chance_display" style="font-weight:bold;">50%</span>
                </label>
                <input type="range" id="autopulse_jealousy_chance" min="0" max="100" value="50" style="width:100%;" />
            </div>

            <div class="autopulse-setting-group">
                <label style="display:flex; justify-content:space-between;">
                    <span>最短延迟（秒）</span>
                    <span id="autopulse_jealousy_delay_min_display" style="font-weight:bold;">30s</span>
                </label>
                <input type="range" id="autopulse_jealousy_delay_min" min="5" max="300" value="30"
                    style="width:100%;" />
            </div>

            <div class="autopulse-setting-group">
                <label style="display:flex; justify-content:space-between;">
                    <span>最长延迟（秒）</span>
                    <span id="autopulse_jealousy_delay_max_display" style="font-weight:bold;">120s</span>
                </label>
                <input type="range" id="autopulse_jealousy_delay_max" min="10" max="600" value="120"
                    style="width:100%;" />
            </div>

            <div class="autopulse-actions" style="margin-top:10px;">
                <div id="autopulse_test_jealousy" class="menu_button" title="立即触发当前角色的嫉妒消息">
                    <span class="fa-solid fa-fire"></span>
                    <span>测试嫉妒弹窗</span>
                </div>
            </div>

            <hr />

            <!-- Info Notice -->
            <div class="autopulse-notice">
                <span class="fa-solid fa-circle-info"></span>
                <span>Lite 版本：定时器在浏览器中运行，关闭页面后会停止。如需后台持续运行，请使用 <a href="https://github.com/NANA3333333/ST-AutoPulse"
                        target="_blank">完整版 ST-AutoPulse</a>。</span>
            </div>

        </div>
    </div>
</div>